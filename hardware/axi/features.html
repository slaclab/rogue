

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Additional AxiStreamDma Features &mdash; Rogue v6.4.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=bad8783d"></script>
      <script src="../../_static/doctools.js?v=888ff710"></script>
      <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="AXI Hardware Interface Class Descriptions" href="classes/index.html" />
    <link rel="prev" title="Using The AxiMemMap Class" href="memory.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Rogue
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installing/index.html">Installing &amp; Compiling Rogue</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pyrogue_tree/index.html">PyRogue Tree</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../interfaces/index.html">Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../utilities/index.html">Utilities</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Hardware</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Generic AXI Hardware Interface</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="stream.html">Using The AxiStreamDma Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="memory.html">Using The AxiMemMap Class</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Additional AxiStreamDma Features</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#kernel-module-debug">Kernel Module Debug</a></li>
<li class="toctree-l4"><a class="reference internal" href="#zerocopy-enable">ZeroCopy Enable</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dma-acknowledge">DMA Acknowledge</a></li>
<li class="toctree-l4"><a class="reference internal" href="#frame-send-timeout">Frame Send Timeout</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="classes/index.html">AXI Hardware Interface Class Descriptions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../pgp/index.html">PGP Card Hardware Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../raw/index.html">Raw Hardware Interface</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../protocols/index.html">Protocols</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../logging/index.html">Logging In Rogue</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../custom_module/index.html">Creating Custom Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pydm/index.html">Using the PyDM Gui</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../migration/index.html">Migration Notes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Rogue</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Hardware</a></li>
          <li class="breadcrumb-item"><a href="index.html">Generic AXI Hardware Interface</a></li>
      <li class="breadcrumb-item active">Additional AxiStreamDma Features</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/hardware/axi/features.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="additional-axistreamdma-features">
<span id="hardware-axi-features"></span><h1>Additional AxiStreamDma Features<a class="headerlink" href="#additional-axistreamdma-features" title="Permalink to this heading"></a></h1>
<p>The following features are available in the AxiStreamDma class which
may be necessary for some operation modes.</p>
<p>All of these features are described in detail at <a class="reference internal" href="classes/axiStreamDma.html#hardware-axi-axi-stream-dma"><span class="std std-ref">AxiStreamDma</span></a>.</p>
<section id="kernel-module-debug">
<h2>Kernel Module Debug<a class="headerlink" href="#kernel-module-debug" title="Permalink to this heading"></a></h2>
<p>Most of the lower level kernel modules which are used with the AxiStreamDma
class have a debugging mode. This can be enabled by the user with the following
calls:</p>
<p>In Python:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">axiStream</span><span class="o">.</span><span class="n">setDriverDebug</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>In C++:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">axiStream</span><span class="o">-&gt;</span><span class="n">setDriverDebug</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
</pre></div>
</div>
<p>The debug messages can then be viewed using the dmesg command in Linux:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ dmesg
</pre></div>
</div>
</section>
<section id="zerocopy-enable">
<h2>ZeroCopy Enable<a class="headerlink" href="#zerocopy-enable" title="Permalink to this heading"></a></h2>
<p>By default the AxiStreamDma class interacts with the underlying driver using
its zero copy buffer mode if available. The user’s implementation may choose
to avoid this by asserting rogue::interface::memory::reqFrame() calls with
the zeroCopyEn flag set to false.</p>
<p>Alternatively the zero copy mode can be disabled globally for all interactions
with the AxiStreamDma class using the following call:</p>
<p>In Python:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">axiStream</span><span class="o">.</span><span class="n">setZeroCopyEn</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>In C++:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">axiStream</span><span class="o">-&gt;</span><span class="n">setZeroCopyEn</span><span class="p">(</span><span class="n">false</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="dma-acknowledge">
<h2>DMA Acknowledge<a class="headerlink" href="#dma-acknowledge" title="Permalink to this heading"></a></h2>
<p>Some versions of the lower level driver and the underlying hardware will support
a DMA Acknowledge function which pulses a logic signal in the lower level firmware.
This was used in some experiments which need more complex handshakes between software
and firmware. The following method can be used to trigger this acknowledge.</p>
<p>In Python:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">axiStream</span><span class="o">.</span><span class="n">dmaAck</span><span class="p">()</span>
</pre></div>
</div>
<p>In C++:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">axiStream</span><span class="o">-&gt;</span><span class="n">dmaAck</span><span class="p">();</span>
</pre></div>
</div>
</section>
<section id="frame-send-timeout">
<h2>Frame Send Timeout<a class="headerlink" href="#frame-send-timeout" title="Permalink to this heading"></a></h2>
<p>In some cases the lower level driver will not be ready when allocating new
buffers or sending frames. After a defined timeout the AxiStreamDma class
will generate a warning message but continue to wait for the driver. The following
method will adjust the period between warning messages. The passed value is the
timeout period in microseconds.</p>
<p>In Python:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">axiStream</span><span class="o">.</span><span class="n">setTimeout</span><span class="p">(</span><span class="mi">1500</span><span class="p">)</span>
</pre></div>
</div>
<p>In C++:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">axiStream</span><span class="o">-&gt;</span><span class="n">setTimeout</span><span class="p">(</span><span class="mi">1500</span><span class="p">);</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="memory.html" class="btn btn-neutral float-left" title="Using The AxiMemMap Class" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="classes/index.html" class="btn btn-neutral float-right" title="AXI Hardware Interface Class Descriptions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, SLAC National Accelerator Laboratory.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>